{% load static %}

<style>
    /* Custom styles from reference for this component */
    .font-pixel {
        font-family: 'Press Start 2P', cursive;
    }
    .nav-icon-active img {
         filter: drop-shadow(0 0 5px #00f5d4) drop-shadow(0 0 10px #00f5d4);
    }
    .nav-icon-inactive img {
         filter: drop-shadow(0 0 2px #4b5563) drop-shadow(0 0 4px #6b7280);
    }
    .nav-icon-active-desktop {
        background-color: #2a2a2a;
        box-shadow: inset 2px 2px 0px 0px #00f5d444;
    }
    .mobile-nav {
        background-color: #111 !important;
        opacity: 1 !important;
    }
</style>

<!-- Sidebar Navigation (Desktop) -->
<nav id="desktop-nav" class="hidden md:flex flex-col w-48 bg-[#111] border-r-4 border-black p-4 flex-shrink-0 fixed left-0 top-0 h-screen overflow-y-auto opacity-100">
    <div class="flex-shrink-0 mb-8">
        <h1 class="font-pixel text-lg text-white tracking-wider text-center">FLEXIN.GG</h1>
    </div>
    <div class="flex-grow overflow-y-auto space-y-2">
        <a href="{% url 'fitness:home' %}" data-tab="dash" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a] {% if request.path == '/' %}text-[#00f5d4] nav-icon-active-desktop{% endif %}">
            <img src="{% static 'icons/home.png' %}" alt="Dashboard" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Dash</span>
        </a>
        {% if user.is_authenticated %}
        <a href="{% url 'social:main' %}" data-tab="social" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a] {% if request.path == '/social/' %}text-[#00f5d4] nav-icon-active-desktop{% endif %}">
            <img src="{% static 'icons/world.png' %}" alt="Social" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Social</span>
        </a>
        <a href="{% url 'fitness:comingsoon' %}" data-tab="gym" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/dumbbell.png' %}" alt="Gym" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Gym</span>
        </a>
        <a href="{% url 'fitness:comingsoon' %}" data-tab="lockers" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/locker.png' %}" alt="Lockers" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Lockers</span>
        </a>
        <a href="{% url 'fitness:comingsoon' %}" data-tab="profile" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/person.png' %}" alt="Profile" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Profile</span>
        </a>
        {% else %}
        <a href="{% url 'fitness:sign_in' %}" data-tab="social" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/world.png' %}" alt="Social" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Social</span>
        </a>
        <a href="{% url 'fitness:sign_in' %}" data-tab="gym" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/dumbbell.png' %}" alt="Gym" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Gym</span>
        </a>
        <a href="{% url 'fitness:sign_in' %}" data-tab="lockers" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/locker.png' %}" alt="Lockers" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Lockers</span>
        </a>
        <a href="{% url 'fitness:sign_in' %}" data-tab="profile" class="flex items-center p-3 rounded-lg text-gray-500 hover:text-white hover:bg-[#2a2a2a]">
            <img src="{% static 'icons/person.png' %}" alt="Profile" class="w-6 h-6 flex-shrink-0">
            <span class="text-sm font-pixel ml-3">Profile</span>
        </a>
        {% endif %}
    </div>
</nav>

<!-- Bottom Navigation Bar for Mobile -->
<nav id="mobile-nav" class="w-full bg-[#111] border-t-4 border-black flex justify-around flex-shrink-0 md:hidden fixed bottom-0 left-0 right-0 z-50 opacity-100 mobile-nav">
    <a href="{% url 'fitness:home' %}" data-tab="dash" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500 {% if request.path == '/' %}text-[#00f5d4] nav-icon-active{% endif %}">
        <img src="{% static 'icons/home.png' %}" alt="Dashboard" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1 {% if request.path == '/' %}text-[#00f5d4]{% endif %}">Dash</span>
    </a>
    {% if user.is_authenticated %}
    <a href="{% url 'social:main' %}" data-tab="social" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500 {% if request.path == '/social/' %}text-[#00f5d4] nav-icon-active{% endif %}">
        <img src="{% static 'icons/world.png' %}" alt="Social" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1 {% if request.path == '/social/' %}text-[#00f5d4]{% endif %}">Social</span>
    </a>
    <a href="{% url 'fitness:comingsoon' %}" data-tab="gym" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/dumbbell.png' %}" alt="Gym" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Gym</span>
    </a>
    <a href="{% url 'fitness:comingsoon' %}" data-tab="lockers" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/locker.png' %}" alt="Lockers" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Lockers</span>
    </a>
    <a href="{% url 'fitness:comingsoon' %}" data-tab="profile" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/person.png' %}" alt="Profile" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Profile</span>
    </a>
    {% else %}
    <a href="{% url 'fitness:sign_in' %}" data-tab="social" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/world.png' %}" alt="Social" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Social</span>
    </a>
    <a href="{% url 'fitness:sign_in' %}" data-tab="gym" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/dumbbell.png' %}" alt="Gym" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Gym</span>
    </a>
    <a href="{% url 'fitness:sign_in' %}" data-tab="lockers" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/locker.png' %}" alt="Lockers" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Lockers</span>
    </a>
    <a href="{% url 'fitness:sign_in' %}" data-tab="profile" class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500">
        <img src="{% static 'icons/person.png' %}" alt="Profile" class="w-7 h-7 flex-shrink-0">
        <span class="text-xs font-pixel mt-1">Profile</span>
    </a>
    {% endif %}
</nav>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const desktopNav = document.getElementById('desktop-nav');
        const mobileNav = document.getElementById('mobile-nav');
        if (!desktopNav && !mobileNav) return;

        const tabs = ['dash', 'social', 'gym', 'lockers', 'profile'];
        const activeKey = 'activeNavTab';

        function updateActive(tab) {
            // Update desktop
            if (desktopNav) {
                desktopNav.querySelectorAll('a').forEach(a => {
                    a.classList.remove('text-[#00f5d4]', 'nav-icon-active-desktop', 'nav-icon-inactive');
                    if (a.dataset.tab === tab) {
                        a.classList.add('text-[#00f5d4]', 'nav-icon-active-desktop');
                    } else {
                        a.classList.add('nav-icon-inactive');
                    }
                });
            }
            // Update mobile
            if (mobileNav) {
                mobileNav.querySelectorAll('a').forEach(a => {
                    a.classList.remove('text-[#00f5d4]', 'nav-icon-active', 'nav-icon-inactive');
                    if (a.dataset.tab === tab) {
                        a.classList.add('text-[#00f5d4]', 'nav-icon-active');
                    } else {
                        a.classList.add('nav-icon-inactive');
                    }
                });
            }
            localStorage.setItem(activeKey, tab);
        }

        // Initial load
        let activeTab = localStorage.getItem(activeKey) || 'dash';
        updateActive(activeTab);

        // Click handlers
        [desktopNav, mobileNav].forEach(nav => {
            if (nav) {
                nav.addEventListener('click', function(e) {
                    const a = e.target.closest('a[data-tab]');
                    if (a && a.dataset.tab) {
                        updateActive(a.dataset.tab);
                    }
                });
            }
        });
    });
</script>
